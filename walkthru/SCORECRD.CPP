/*------------------------------------------------------------------------------ * Virtus WalkThrough_ * Version 1.1.1 * * Copyright _ 1990-1992 by Virtus Corporation * All Rights Reserved * Written by   *				 *				Mark J. Uland * Virtus Corporation * Suite 204 * 117 Edinburgh South * Cary, North Carolina    27511 * (919) 467-9700 *------------------------------------------------------------------------------ * Source File:  * Notes:  * History:  *------------------------------------------------------------------------------ */#include "VTypes.h"#include "ScoreCrd.h"#include "Layout.h"#include "AppText.h"#include "AppDeflt.h"#include "AppFiles.h"#include "Misc.h"#include "VGraphic.h"#include "VTextDef.h"#include <stdio.h>#include <string.h>#if MACINTOSH#define SCORE_HEIGHT	129#define SCORE_WIDTH_MIN	80	#elif WINDOWS#define SCORE_HEIGHT	153#define SCORE_WIDTH_MIN	180	#endif //WINDOWS	voidScoreCard::cScoreCard(char *str,ScoreRecord *scoreRec)	{	V_CtrlButton_Die 	*button;	V_Text	*statText;    V_Icon	*icon;	char	numCrt[256],numSurfU[256],numSurfD[256],titleStr[256],objStr[32];	Rect	br,r;	int		numberCreated,numSurfUsed,numSurfDisc,width,tmpWidth;		switch(scoreRec->type)		{		case format3DDXF: 			numberCreated = scoreRec->dxfRec.numConstructed; 			numSurfUsed = scoreRec->dxfRec.numSurfUsed;			numSurfDisc = scoreRec->dxfRec.numSurfDiscard;				break;		}		TextSetUp(vSystemFont,vSystemFontSize,vNormal);	strcpy(objStr,TXTD_IMPOBJ);	if(numberCreated!=1)strcat(objStr,TXTD_IMPPLURAL);	sprintf(numCrt,"%i %s %s",numberCreated,objStr,layoutSpec[scoreObjCreated].title);	strcpy(objStr,TXTD_IMPSURF);	if(numberCreated!=1)strcat(objStr,TXTD_IMPPLURAL);	sprintf(numSurfU,"%i %s %s",numSurfUsed,objStr,layoutSpec[scoreSurfUsed].title);	strcpy(objStr,TXTD_IMPSURF);	if(numberCreated!=1)strcat(objStr,TXTD_IMPPLURAL);	sprintf(numSurfD,"%i %s %s",numSurfDisc,objStr,layoutSpec[scoreSurfDisc].title);	width = VTextWidth(titleStr,0,strlen(layoutSpec[scoreTitle].title));	if(width < (tmpWidth = VTextWidth(numCrt,0,strlen(numCrt)))) width = tmpWidth;	if(width < (tmpWidth = VTextWidth(numSurfU,0,strlen(numSurfU)))) width = tmpWidth;	if(width < (tmpWidth = VTextWidth(numSurfD,0,strlen(numSurfD)))) width = tmpWidth;		width += 36;	if(width<SCORE_WIDTH_MIN)width = SCORE_WIDTH_MIN + 36;	CenterDialog(&r,width,SCORE_HEIGHT,0);			cDialog(&r);    SetTitle(TXT_APPNAME);#if WINDOWS	r = layoutSpec[scoreIcon].destRect;	icon = new(V_Icon);	icon->cItem();	icon->SetRect(&r);	icon->SetIconID(ALERT_ICON_ID);	AddItem(icon);#endif //WINDOWS	r = layoutSpec[scoreTitle].destRect;	r.right = width;	statText = new(V_Text);	statText->cItem();	statText->SetRect(&r);	statText->SetText(layoutSpec[scoreTitle].title);	AddItem(statText);	r = layoutSpec[scoreObjCreated].destRect;	r.right = width;	statText = new(V_Text);	statText->cItem();	statText->SetRect(&r);	statText->SetText(numCrt);	AddItem(statText);	r = layoutSpec[scoreSurfUsed].destRect;	r.right = width;	statText = new(V_Text);	statText->cItem();	statText->SetRect(&r);	statText->SetText(numSurfU);	AddItem(statText);	r = layoutSpec[scoreSurfDisc].destRect;	r.right = width;	statText = new(V_Text);	statText->cItem();	statText->SetRect(&r);	statText->SetText(numSurfD);	AddItem(statText);	GetRect(&r);#if MACINTOSH	br.bottom = r.bottom-13;	br.top = br.bottom-18;	br.left = r.right-93;	br.right = br.left+80;	#elif WINDOWS	br.left = (r.right-D_BTNW) >> 1;	br.right = br.left + D_BTNW;	br.bottom = r.bottom - D_EDGE; 	br.top = br.bottom - D_BTNH;#endif ///WINDOWS	button = new(V_CtrlButton_Die);	button->cItem();	button->SetRect(&br);	button->SetText(TXTC_OK);	button->SetFlag(TRUE);	SetDefBtn(button);#if WINDOWS	button->SetCtrlNumber(IDOK);#endif	AddItem(button);	useOffscreen = TRUE;			Show();	Modal();	Delete();	}